<script lang="ts">
	let recognition_textarea: HTMLTextAreaElement;
	let english_textarea: HTMLTextAreaElement;
	let japanese_textarea: HTMLTextAreaElement;

	function speech(text: string, lang: string): void {
		const utterance = new SpeechSynthesisUtterance();

		utterance.text = text;
		utterance.lang = lang;
		utterance.rate = 1;
		utterance.pitch = 1;
		utterance.volume = 1;

		speechSynthesis.speak(utterance);
	}

	function speech_in_english(): void {
		speech(english_textarea.value, 'en-US');
	}

	function speech_in_japanese(): void {
		speech(japanese_textarea.value, 'ja-JP');
	}

	function recognition(lang: string): void {
		if (!('webkitSpeechRecognition' in window)) {
			recognition_textarea.value = 'Speech Recognition Not Available'
			return
		}

		recognition_textarea.value = 'Recognition...'

		const speech_recognition = window.SpeechRecognition || window.webkitSpeechRecognition;
		const recognition = new speech_recognition();

		recognition.lang = lang;
		recognition.interimResults = false;
		recognition.maxAlternatives = 1;

    // eslint-disable-next-line @typescript-eslint/no-explicit-any
		recognition.onresult = (event: any): void => {
			const result = event.results[0][0].transcript;
			recognition_textarea.value = result;
		};

		recognition.start();
	}

	function recognition_in_english(): void {
		recognition('en-US');
	}

	function recognition_in_japanese(): void {
		recognition('ja-JP');
	}
</script>

<h1>Welcome to Talk</h1>
<p>
	Visit <a href="https://github.com/sinProject-Inc/favorite">https://github.com/sinProject-Inc/favorite</a> to
	read the documentation
</p>

Speech Recognition
<textarea
	readonly
	placeholder="Press the button and say something"
	size="60"
	bind:this={recognition_textarea}
/>
<button on:click={recognition_in_english}>English</button>
<button on:click={recognition_in_japanese}>Japanese</button>

<br /><br />

English
<textarea
	placeholder="Enter text to speech in English"
	size="60"
	value="Hello world!"
	bind:this={english_textarea}
/>
<button on:click={speech_in_english}>Text-to-Speech</button>

<br /><br />

Japanese
<textarea
	placeholder="Enter text to speech in Japanese"
	size="60"
	value="こんにちは、世界"
	bind:this={japanese_textarea}
/>
<button on:click={speech_in_japanese}>Text-to-Speech</button>

<style>
	textarea {
		width: 100%;
		height: 100px;
	}
</style>
